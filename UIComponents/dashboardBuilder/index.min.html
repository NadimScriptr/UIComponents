<html ng-app="myApp">
<head>
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel="shortcut icon" type="image/x-icon" href="https://www.scriptr.io/themes/scriptr/images/favicon.ico">
    <title>Dashboard Builder</title>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="//use.fontawesome.com/cb4ba0acea.js"></script>  
    <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,700" rel="stylesheet">
  
    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="/UIComponents/build/css/components.min.css"/>
    
    <link name="light" rel="stylesheet" href="/UIComponents/dashboardBuilder/css/light.css"> 
    <link name="dark" disabled="true" rel="stylesheet" href="/UIComponents/dashboardBuilder/css/dark.css"> <!-- this the default theme -->
      
    <!-- JQUERY Material  To use jQuery, simply ensure it is loaded before the angular.js file. -->
    <script src="/UIComponents/build/js/external_jquery_resources.min.js"></script>
    <script src="/UIComponents/build/js/external_libraries1.min.js"></script>	
    <script src="/UIComponents/build/js/external_libraries2.min.js"></script>	
    
    <script src="//maps.google.com/maps/api/js?key=AIzaSyBcPYghFh_BXz4dDz-TXTHbU2iV3Wbf57I&libraries=drawing,visualization"></script>
    
    <!-- Constants -->
    <script src="/modules/login/widgets/authorization.js"></script>
  
    <!-- NG material -->
    <script src="/UIComponents/build/js/angular_resources_1.min.js"></script>
    <script src="/UIComponents/build/js/angular_resources_2.min.js"></script>
    <script src="/UIComponents/build/js/angular_resources_3.min.js"></script>
    
    <script src="/UIComponents/build/js/templates.js"></script>
    
    <script src="//cdnjs.cloudflare.com/ajax/libs/ag-grid/12.0.0/ag-grid.js?ignore=notused36"></script>

	<script src="//cdnjs.cloudflare.com/ajax/libs/p5.js/1.0.0/p5.min.js"></script>
    <!-- Directives -->
    <script src="/UIComponents/build/js/directives_1.min.js"></script>
    <script src="/UIComponents/build/js/directives_2.min.js"></script>
    
    <!-- Libraries -->
    <script src="//cdn.plot.ly/plotly-latest.min.js"></script>
  
    <script src="/UIComponents/build/js/dashboard_builder_constants.min.js"></script>
    
    <!-- Components -->
    <script src="/UIComponents/build/js/components.min.js"></script>
    <script src="/UIComponents/build/js/editor.min.js"></script>
    
    
    <script src="/login/view/javascript/authorization.js"> </script>
    <script src="/login/view/javascript/config.js"></script>
    
    <script src="/UIComponents/config/scriptrTransport.js"></script>
    
    <style id="dashboardCustomStyle">
    </style>
    
    <style id="dashboardInlineStyle">
    </style>
    
    <style id="dashboardPreviewCustomStyle">
    </style>
    
    <style id="dashboardPreviewInlineStyle">
    </style>
</head> 
  
<script type="text/javascript"> 
(function ($) { 
    Handlebars.registerHelper('if_eq', function(a, b, opts) {
        if(a === b) // Or === depending on your needs
            return opts.fn(this);
        else
            return opts.inverse(this);
    });
    Handlebars.registerHelper('buildAttr', function(options, block) {
            var accum = '';
            for(option in options){
                var temp = null;
                if(option == 'on-format-data' || option == 'functions') continue;
                if(option == 'info-window') continue;
                if(typeof options[option] == 'object'){
                    temp = JSON.stringify(options[option]);
                   // console.log("option object "+option, temp)
                } else {
                    temp = options[option]
                    //console.log("option not object "+option, temp)
                }
                accum += "\t\t\t\t\t\t\t\t\t\t" + option + "=" + "'" + temp +"'\n";
            }

        return accum;
    });
     var myApp= angular.module("myApp", ['DashboardBuilder']);
     $.urlParam = function(name){
    		var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
    		if (results==null){
      			return null;
    		}else{
       			return results[1] || 0;
    		}
	}
    
     var authorization  = $.scriptr.authorization({
         onTokenValid: function(){ }, 
         loginPage: config.loginPage,
         validateTokenApi: login.validateTokenApi
	 });
    
	angular.module('myApp').config(wssConfig);
    angular.module('myApp').config(httpsConfig);
    angular.module('myApp').run(function(editableOptions, editableThemes) {
        editableThemes.bs3.buttonsClass = 'btn-md';
        editableThemes.bs3.submitTpl = '<button type="submit" class="btn btn-primary" title="Submit" aria-label="Submit"><span class="glyphicon glyphicon-ok"></span></button>';
        editableOptions.theme = 'bs3'; // bootstrap3 theme. Can be also 'bs2', 'default'
     });
  
    
    angular.module('myApp').run(cachedTemplates).config(function($routeProvider){
           $routeProvider
            .when("/", {
            	templateUrl: '/UIComponents/dashboardBuilder/view/dashboardsList.html'
          	})
            .when("/dashboardsList", {
            	templateUrl: '/UIComponents/dashboardBuilder/view/dashboardsList.html'
          	})
            .when("/newDashboard",{
               templateUrl: '/UIComponents/dashboardBuilder/view/dashboard.html'
            })
            .when("/scriptrIdeRef/:scriptrIdeRef*", {
            	templateUrl: '/UIComponents/dashboardBuilder/view/dashboard.html'
          	})
          	.when('/scriptName/:scriptName*', {
              	templateUrl: '/UIComponents/dashboardBuilder/view/dashboard.html',
             	controller:  'dashboardCtrl',
              	controllerAs: "vm"
            })
           .when('/logout', {
              	templateUrl: '/UIComponents/dashboardBuilder/view/logout.html'
            }) 
            .otherwise({redirectTo:'/'})
       })
   	  angular.module('myApp').controller('dashboardCtrl', function($scope, httpClient, $sce, $route, $routeParams) {
          var vm = this;
          //vm.user = (atob(document.cookie.split("=")[1]).split(":")[1])
      });
 }(jQuery));   
</script>

    <!--script src="/UIComponents/dashboardBuilder/javascript/dashboard.js"></script-->
<body ng-controller="dashboardCtrl as vm" class="dashboardTheme" lang="en">
   <!--header-top user="vm.user" header-items='{
           "appname": "Dashboard Builder",
           "logout": {"route":"#/logout"}
        }'></header-top-->
  <div>
     <ng-view></ng-view>
 	 <div ng-include="'/UIComponents/dashboardBuilder/view/dashboardTemplate.min'"></div>
      <div ng-include="'/UIComponents/dashboardBuilder/css/customStyleTemplate.css'"></div>
  </div>
</body>  
</html>